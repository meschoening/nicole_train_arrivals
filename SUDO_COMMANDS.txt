# Sudo Commands Required by WiFi Setup Feature

Commands used in wifi_setup.py and wifi_portal_server.py that require sudo privileges.
The application user should have passwordless sudo access for these commands.

## WiFi Setup (wifi_setup.py)

### Starting AP Mode:
sudo nmcli device disconnect wlan0
sudo ip addr flush dev wlan0
sudo ip addr add 192.168.4.1/24 dev wlan0
sudo ip link set wlan0 up
sudo systemctl start dnsmasq
sudo hostapd -B /path/to/hostapd_provisioning.conf

### Stopping AP Mode:
sudo killall hostapd
sudo systemctl stop dnsmasq
sudo ip addr flush dev wlan0
sudo systemctl restart NetworkManager

## WiFi Portal Server (wifi_portal_server.py)

sudo nmcli device wifi rescan
sudo nmcli connection add type wifi con-name <SSID> ssid <SSID> [wifi-sec.key-mgmt wpa-psk wifi-sec.psk <password>]
sudo nmcli connection delete <connection-name>

## Existing Commands (main_display.py, web_settings_server.py)

sudo shutdown now
sudo shutdown -r now
sudo -u max git pull
sudo -u max git log -1 --format=%s
sudo timedatectl set-timezone <timezone>

## SSL Certificate Generation (web_settings_server.py)

sudo tailscale cert --cert-file <path> --key-file <path> <hostname>
sudo chown <user> <cert_file> <key_file>

---

# Sudoers Configuration

Add to /etc/sudoers via `sudo visudo`:

```
max ALL=(ALL) NOPASSWD: /usr/bin/nmcli
max ALL=(ALL) NOPASSWD: /usr/sbin/ip
max ALL=(ALL) NOPASSWD: /usr/bin/systemctl start dnsmasq
max ALL=(ALL) NOPASSWD: /usr/bin/systemctl stop dnsmasq
max ALL=(ALL) NOPASSWD: /usr/bin/systemctl restart NetworkManager
max ALL=(ALL) NOPASSWD: /usr/sbin/hostapd
max ALL=(ALL) NOPASSWD: /usr/bin/killall hostapd
max ALL=(ALL) NOPASSWD: /sbin/shutdown
max ALL=(ALL) NOPASSWD: /usr/bin/timedatectl
max ALL=(ALL) NOPASSWD: /usr/bin/tailscale cert *
max ALL=(ALL) NOPASSWD: /bin/chown *
```

Replace "max" with your application user.
